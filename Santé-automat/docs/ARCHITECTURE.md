# ğŸ—ï¸ Architecture du Projet

## Vue d'ensemble

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      main_new.py                            â”‚
â”‚                  (Point d'entrÃ©e principal)                 â”‚
â”‚                                                             â”‚
â”‚  â€¢ Parse les arguments (--dev, --force)                    â”‚
â”‚  â€¢ Orchestre tous les modules                              â”‚
â”‚  â€¢ Affiche les messages de progression                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â”‚ importe et utilise
                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚
        â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  config.py   â”‚      â”‚dev_logger.py â”‚
â”‚              â”‚      â”‚              â”‚
â”‚ â€¢ PDF_FOLDER â”‚      â”‚ â€¢ log_raw    â”‚
â”‚ â€¢ OUTPUT_FILEâ”‚      â”‚ â€¢ log_filter â”‚
â”‚ â€¢ WHITELIST  â”‚      â”‚ â†’ dev.txt    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                     â”‚
        â”‚ utilisÃ© par         â”‚ optionnel
        â”‚                     â”‚
        â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         pdf_extractor.py                â”‚
â”‚                                         â”‚
â”‚  â€¢ Charge banlist.txt                  â”‚
â”‚  â€¢ Extrait texte brut avec pdfplumber â”‚
â”‚  â€¢ Parse la date de prÃ©lÃ¨vement       â”‚
â”‚  â€¢ Filtre selon whitelist/banlist     â”‚
â”‚  â€¢ Log en mode --dev                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ retourne (date, results)
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      thresholds_manager.py              â”‚
â”‚                                         â”‚
â”‚  â€¢ Charge seuils.json                  â”‚
â”‚  â€¢ Met Ã  jour depuis PDF               â”‚
â”‚  â€¢ Sauvegarde automatique              â”‚
â”‚  â€¢ Fournit min/max par paramÃ¨tre       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ utilisÃ© par
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         excel_manager.py                â”‚
â”‚                                         â”‚
â”‚  â€¢ Met Ã  jour resultats.xlsx           â”‚
â”‚  â€¢ RÃ©ordonne colonnes par date         â”‚
â”‚  â€¢ Colorise (vert/rouge)               â”‚
â”‚  â€¢ GÃ©nÃ¨re graphiques (onglet sÃ©parÃ©)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ produit
             â”‚
             â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚resultats.xlsxâ”‚
      â”‚             â”‚
      â”‚ Onglet 1:   â”‚
      â”‚  DonnÃ©es    â”‚
      â”‚  colorisÃ©es â”‚
      â”‚             â”‚
      â”‚ Onglet 2:   â”‚
      â”‚  Graphiques â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Flux de donnÃ©es

```
ğŸ“„ PDF files (pdfs/)
    â”‚
    â”‚ [1] PDFExtractor lit chaque PDF
    â”‚
    â”œâ”€â†’ Texte brut extrait
    â”‚   â”‚
    â”‚   â”œâ”€â†’ ğŸ” Mode --dev : Ã©crit dans dev.txt
    â”‚   â”‚
    â”‚   â””â”€â†’ Parse date + rÃ©sultats
    â”‚       â”‚
    â”‚       â”œâ”€â†’ Filtre avec WHITELIST
    â”‚       â”œâ”€â†’ Exclut avec banlist.txt
    â”‚       â”‚
    â”‚       â””â”€â†’ RÃ©sultats filtrÃ©s
    â”‚           â”‚
    â”‚           â””â”€â†’ ğŸ” Mode --dev : Ã©crit dans dev.txt
    â”‚
    â”œâ”€â†’ [2] ThresholdsManager
    â”‚   â”‚
    â”‚   â”œâ”€â†’ Lit seuils.json
    â”‚   â”œâ”€â†’ Met Ã  jour avec intervalles du PDF
    â”‚   â””â”€â†’ Sauvegarde seuils.json
    â”‚
    â””â”€â†’ [3] ExcelManager
        â”‚
        â”œâ”€â†’ Lit resultats.xlsx (si existe)
        â”œâ”€â†’ Ajoute nouvelle colonne (date)
        â”œâ”€â†’ RÃ©ordonne colonnes chronologiquement
        â”œâ”€â†’ Colorise avec seuils (vert/rouge)
        â”œâ”€â†’ GÃ©nÃ¨re graphiques d'Ã©volution
        â””â”€â†’ Sauvegarde resultats.xlsx

ğŸ“Š resultats.xlsx (mis Ã  jour)
ğŸ“ dev.txt (si --dev activÃ©)
```

## Diagramme de dÃ©pendances

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   main.py   â”‚
                    â”‚  (ANCIEN)   â”‚
                    â”‚             â”‚
                    â”‚ Monolithiqueâ”‚
                    â”‚  ~400 lignesâ”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ REFACTORING
                          â”‚
                          â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                     â”‚
        â”‚    main_new.py (50 lignes)        â”‚
        â”‚                                     â”‚
        â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚       â”‚        â”‚         â”‚
           â”‚       â”‚        â”‚         â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”  â”Œâ”€â–¼â”€â”€â”€â”€â”€â”€â”â”Œâ–¼â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚config  â”‚  â”‚dev_    â”‚â”‚pdf_     â”‚â”‚thresholds_â”‚
    â”‚.py     â”‚  â”‚logger  â”‚â”‚extractorâ”‚â”‚manager.py â”‚
    â”‚        â”‚  â”‚.py     â”‚â”‚.py      â”‚â”‚           â”‚
    â”‚25 linesâ”‚  â”‚80 linesâ”‚â”‚95 lines â”‚â”‚85 lines   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚excel_manager.pyâ”‚
                        â”‚                â”‚
                        â”‚   215 lines    â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

TOTAL: ~550 lignes (vs 400 lignes monolithiques)
BUT: ModularitÃ©, testabilitÃ©, mode --dev
```

## Mode dÃ©veloppement (--dev)

```
$ python main_new.py --dev --force

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Initialisation                 â”‚
â”‚                                     â”‚
â”‚  âœ“ DevLogger activÃ©                â”‚
â”‚  âœ“ Charge banlist.txt              â”‚
â”‚  âœ“ Charge seuils.json              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ Pour chaque PDF
             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Extraction PDF   â”‚
    â”‚                  â”‚
    â”‚ â†“ Texte brut     â”‚  â”€â”€â”€â”€â”€â†’ dev.txt
    â”‚ â†“ Date           â”‚  â”€â”€â”€â”€â”€â†’ dev.txt
    â”‚ â†“ Parse          â”‚
    â”‚ â†“ Filtre         â”‚
    â”‚ â†“ RÃ©sultats      â”‚  â”€â”€â”€â”€â”€â†’ dev.txt
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Mise Ã  jour      â”‚
    â”‚                  â”‚
    â”‚ â†“ Excel          â”‚
    â”‚ â†“ Seuils         â”‚
    â”‚ â†“ Colorisation   â”‚
    â”‚ â†“ Graphiques     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   RÃ©sultats     â”‚
    â”‚                 â”‚
    â”‚ â€¢ resultats.xlsxâ”‚
    â”‚ â€¢ dev.txt       â”‚ â† NOUVEAU !
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Contenu de dev.txt

```
=== MODE DÃ‰VELOPPEMENT - 2025-10-23 17:17:41 ===

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Section 1 : BANLIST CHARGÃ‰E                â”‚
â”‚                                            â”‚
â”‚ â€¢ Nombre d'Ã©lÃ©ments : 9                    â”‚
â”‚ â€¢ Liste complÃ¨te des exclusions           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Section 2 : TEXTE BRUT DU PDF              â”‚
â”‚                                            â”‚
â”‚ [Tout le contenu extrait du PDF]          â”‚
â”‚ â†’ Permet de voir ce que voit le script    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Section 3 : DATE EXTRAITE                  â”‚
â”‚                                            â”‚
â”‚ Date extraite : 01-10-2025                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Section 4 : RÃ‰SULTATS FILTRÃ‰S              â”‚
â”‚                                            â”‚
â”‚ Nombre de paramÃ¨tres : 15                  â”‚
â”‚                                            â”‚
â”‚ â€¢ HÃ©maties: 5.14 T/L (4,28âˆ’6,00)          â”‚
â”‚ â€¢ HÃ©moglobine: 14.9 g/dL (13,4âˆ’16,7)      â”‚
â”‚ â€¢ HÃ©matocrite: 46.0 % (39âˆ’49)             â”‚
â”‚ â€¢ ...                                      â”‚
â”‚                                            â”‚
â”‚ â†’ Permet de voir ce qui a Ã©tÃ© retenu      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[RÃ©pÃ©tÃ© pour chaque PDF traitÃ©]
```

## Comparaison Avant/AprÃ¨s

### AVANT (main.py)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         main.py                     â”‚
â”‚                                     â”‚
â”‚  [Tout le code dans un fichier]    â”‚
â”‚                                     â”‚
â”‚  â€¢ Difficile Ã  maintenir            â”‚
â”‚  â€¢ Pas de visibilitÃ© sur l'extract.â”‚
â”‚  â€¢ DÃ©bogage difficile               â”‚
â”‚  â€¢ Code mÃ©langÃ©                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### APRÃˆS (Structure modulaire)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Modules sÃ©parÃ©s + --dev          â”‚
â”‚                                     â”‚
â”‚  âœ… Code organisÃ© par fonction      â”‚
â”‚  âœ… Mode --dev pour voir extraction â”‚
â”‚  âœ… Facile Ã  dÃ©boguer avec dev.txt  â”‚
â”‚  âœ… Modules rÃ©utilisables           â”‚
â”‚  âœ… Tests unitaires possibles       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Utilisation rapide

```bash
# ğŸ” Voir ce que le script extrait et retient
python main_new.py --dev --force

# ğŸ“– Consulter les dÃ©tails
cat dev.txt

# ğŸ“Š Voir les rÃ©sultats
libreoffice resultats.xlsx
```
